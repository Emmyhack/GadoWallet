/*! For license information please see inheritance.js.LICENSE.txt */
(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach(function(t){r(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function r(e,t,n){return(t=u(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function s(n,r,i,a){var s=r&&r.prototype instanceof u?r:u,d=Object.create(s.prototype);return o(d,"_invoke",function(n,r,i){var o,a,s,u=0,d=i||[],l=!1,m={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return o=t,a=0,s=e,m.n=n,c}};function p(n,r){for(a=n,s=r,t=0;!l&&u&&!i&&t<d.length;t++){var i,o=d[t],p=m.p,y=o[2];n>3?(i=y===r)&&(s=o[(a=o[4])?5:(a=3,3)],o[4]=o[5]=e):o[0]<=p&&((i=n<2&&p<o[1])?(a=0,m.v=r,m.n=o[1]):p<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,m.n=y,a=0))}if(i||n>1)return c;throw l=!0,r}return function(i,d,y){if(u>1)throw TypeError("Generator is already running");for(l&&1===d&&p(d,y),a=d,s=y;(t=a<2?e:s)||!l;){o||(a?a<3?(a>1&&(m.n=-1),p(a,s)):m.n=s:m.v=s);try{if(u=2,o){if(a||(i="next"),t=o[i]){if(!(t=t.call(o,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,a<2&&(a=0)}else 1===a&&(t=o.return)&&t.call(o),a<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),a=1);o=e}else if((t=(l=m.n<0)?s:n.call(r,m))!==c)break}catch(t){o=e,a=1,s=t}finally{u=1}}return{value:t,done:l}}}(n,i,a),!0),d}var c={};function u(){}function d(){}function l(){}t=Object.getPrototypeOf;var m=[][r]?t(t([][r]())):(o(t={},r,function(){return this}),t),p=l.prototype=u.prototype=Object.create(m);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,o(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return d.prototype=l,o(p,"constructor",l),o(l,"constructor",d),d.displayName="GeneratorFunction",o(l,a,"GeneratorFunction"),o(p),o(p,a,"Generator"),o(p,r,function(){return this}),o(p,"toString",function(){return"[object Generator]"}),(i=function(){return{w:s,m:y}})()}function o(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}o=function(e,t,n,r){function a(t,n){o(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},o(e,t,n,r)}function a(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function s(e){a(o,r,i,s,c,"next",e)}function c(e){a(o,r,i,s,c,"throw",e)}s(void 0)})}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var d=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentStep=1,this.selectedType=null,this.inheritanceConfig={},this.wallet=null,this.network="devnet",this.init()},t=[{key:"init",value:(u=s(i().m(function e(){return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.checkWalletStatus();case 1:return this.setupEventListeners(),this.updateStepUI(),e.n=2,this.loadWalletBalance();case 2:return e.a(2)}},e,this)})),function(){return u.apply(this,arguments)})},{key:"checkWalletStatus",value:(a=s(i().m(function e(){var t,n;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,chrome.runtime.sendMessage({type:"GET_WALLET_STATUS"});case 1:(t=e.v).success&&t.isConnected?(this.wallet=t.wallet,this.network=t.network||"devnet",document.getElementById("networkIndicator").textContent=this.network.charAt(0).toUpperCase()+this.network.slice(1)):(this.showError("Wallet not connected. Please connect your wallet first."),setTimeout(function(){window.close()},3e3)),e.n=3;break;case 2:e.p=2,n=e.v,console.error("Wallet status check error:",n),this.showError("Failed to check wallet status");case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return a.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var e=this;document.getElementById("backButton").addEventListener("click",function(){window.close()}),document.querySelectorAll(".select-type").forEach(function(t){t.addEventListener("click",function(t){e.selectedType=t.target.dataset.type,e.nextStep()})}),document.getElementById("prevStep").addEventListener("click",function(){return e.prevStep()}),document.getElementById("nextStep").addEventListener("click",function(){return e.nextStep()}),document.getElementById("prevStep2").addEventListener("click",function(){return e.prevStep()}),document.getElementById("createInheritance").addEventListener("click",function(){return e.createInheritance()}),document.getElementById("backToWallet").addEventListener("click",function(){return window.close()}),document.getElementById("viewExplorer").addEventListener("click",function(){return e.viewOnExplorer()}),this.setupFormInputs()}},{key:"setupFormInputs",value:function(){var e=this;document.getElementById("heirAddress").addEventListener("input",function(){return e.updateSummary()}),document.getElementById("solAmount").addEventListener("input",function(){return e.updateSummary()}),document.getElementById("inactivityPeriod").addEventListener("change",function(t){"custom"===t.target.value?document.getElementById("customPeriodGroup").classList.remove("hidden"):document.getElementById("customPeriodGroup").classList.add("hidden"),e.updateSummary()}),document.getElementById("customDays").addEventListener("input",function(){return e.updateSummary()}),document.getElementById("tokenHeirAddress").addEventListener("input",function(){return e.updateTokenSummary()}),document.getElementById("tokenMint").addEventListener("input",function(){return e.updateTokenSummary()}),document.getElementById("tokenAmount").addEventListener("input",function(){return e.updateTokenSummary()}),document.getElementById("tokenInactivityPeriod").addEventListener("change",function(t){"custom"===t.target.value?document.getElementById("tokenCustomPeriodGroup").classList.remove("hidden"):document.getElementById("tokenCustomPeriodGroup").classList.add("hidden"),e.updateTokenSummary()}),document.getElementById("tokenCustomDays").addEventListener("input",function(){return e.updateTokenSummary()})}},{key:"loadWalletBalance",value:(o=s(i().m(function e(){var t,n,r;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.wallet){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,chrome.runtime.sendMessage({type:"GET_BALANCE"});case 2:(t=e.v).success&&(n=t.balance.toFixed(4),document.getElementById("availableBalance").textContent="".concat(n," SOL")),e.n=4;break;case 3:e.p=3,r=e.v,console.error("Balance load error:",r);case 4:return e.a(2)}},e,this,[[1,3]])})),function(){return o.apply(this,arguments)})},{key:"nextStep",value:function(){if(1===this.currentStep){if(!this.selectedType)return void this.showError("Please select an inheritance type");this.setupStep2()}else if(2===this.currentStep){if(!this.validateStep2())return;this.setupStep3()}this.currentStep++,this.updateStepUI()}},{key:"prevStep",value:function(){this.currentStep>1&&(this.currentStep--,this.updateStepUI())}},{key:"updateStepUI",value:function(){var e=this;document.querySelectorAll(".step").forEach(function(t,n){n+1<=e.currentStep?t.classList.add("active"):t.classList.remove("active")}),document.querySelectorAll(".setup-step").forEach(function(t,n){n+1===e.currentStep?t.classList.add("active"):t.classList.remove("active")})}},{key:"setupStep2",value:function(){"SOL"===this.selectedType?(document.getElementById("step2Title").textContent="Configure SOL Inheritance",document.getElementById("solConfig").style.display="block",document.getElementById("tokenConfig").style.display="none"):"TOKEN"===this.selectedType&&(document.getElementById("step2Title").textContent="Configure Token Inheritance",document.getElementById("solConfig").style.display="none",document.getElementById("tokenConfig").style.display="block")}},{key:"validateStep2",value:function(){if("SOL"===this.selectedType){var e=document.getElementById("heirAddress").value.trim(),t=parseFloat(document.getElementById("solAmount").value);if(!e)return this.showError("Please enter heir wallet address"),!1;if(!this.validateSolanaAddress(e))return this.showError("Invalid Solana address format"),!1;if(!t||t<=0)return this.showError("Please enter a valid SOL amount"),!1;this.inheritanceConfig={type:"SOL",heirAddress:e,amount:t,inactivityDays:this.getInactivityDays("inactivityPeriod","customDays")}}else if("TOKEN"===this.selectedType){var n=document.getElementById("tokenHeirAddress").value.trim(),r=document.getElementById("tokenMint").value.trim(),i=parseFloat(document.getElementById("tokenAmount").value);if(!n)return this.showError("Please enter heir wallet address"),!1;if(!this.validateSolanaAddress(n))return this.showError("Invalid heir address format"),!1;if(!r)return this.showError("Please enter token mint address"),!1;if(!this.validateSolanaAddress(r))return this.showError("Invalid token mint address format"),!1;if(!i||i<=0)return this.showError("Please enter a valid token amount"),!1;this.inheritanceConfig={type:"TOKEN",heirAddress:n,tokenMint:r,amount:i,inactivityDays:this.getInactivityDays("tokenInactivityPeriod","tokenCustomDays")}}return!0}},{key:"setupStep3",value:function(){var e=document.getElementById("confirmationDetails");"SOL"===this.selectedType?(document.getElementById("confirmIcon").textContent="◎",document.getElementById("confirmTitle").textContent="SOL Inheritance Configuration",e.innerHTML='\n                <div class="detail-row">\n                    <span class="detail-label">Type:</span>\n                    <span class="detail-value">SOL Inheritance</span>\n                </div>\n                <div class="detail-row">\n                    <span class="detail-label">Amount:</span>\n                    <span class="detail-value">'.concat(this.inheritanceConfig.amount,' SOL</span>\n                </div>\n                <div class="detail-row">\n                    <span class="detail-label">Heir Address:</span>\n                    <span class="detail-value">').concat(this.shortenAddress(this.inheritanceConfig.heirAddress),'</span>\n                </div>\n                <div class="detail-row">\n                    <span class="detail-label">Inactivity Period:</span>\n                    <span class="detail-value">').concat(this.inheritanceConfig.inactivityDays," days</span>\n                </div>\n            ")):"TOKEN"===this.selectedType&&(document.getElementById("confirmIcon").textContent="🪙",document.getElementById("confirmTitle").textContent="Token Inheritance Configuration",e.innerHTML='\n                <div class="detail-row">\n                    <span class="detail-label">Type:</span>\n                    <span class="detail-value">Token Inheritance</span>\n                </div>\n                <div class="detail-row">\n                    <span class="detail-label">Token Mint:</span>\n                    <span class="detail-value">'.concat(this.shortenAddress(this.inheritanceConfig.tokenMint),'</span>\n                </div>\n                <div class="detail-row">\n                    <span class="detail-label">Amount:</span>\n                    <span class="detail-value">').concat(this.inheritanceConfig.amount,' tokens</span>\n                </div>\n                <div class="detail-row">\n                    <span class="detail-label">Heir Address:</span>\n                    <span class="detail-value">').concat(this.shortenAddress(this.inheritanceConfig.heirAddress),'</span>\n                </div>\n                <div class="detail-row">\n                    <span class="detail-label">Inactivity Period:</span>\n                    <span class="detail-value">').concat(this.inheritanceConfig.inactivityDays," days</span>\n                </div>\n            "))}},{key:"createInheritance",value:(r=s(i().m(function e(){var t,r,o,a;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,this.showLoading("Creating inheritance..."),(t=document.getElementById("createInheritance")).querySelector(".btn-text").classList.add("hidden"),t.querySelector(".btn-loader").classList.remove("hidden"),t.disabled=!0,e.n=1,chrome.runtime.sendMessage(n({type:"CREATE_INHERITANCE"},this.inheritanceConfig));case 1:if(!(r=e.v).success){e.n=2;break}this.showSuccess(r.signature,r.heirAddress),e.n=3;break;case 2:throw new Error(r.error||"Failed to create inheritance");case 3:e.n=5;break;case 4:e.p=4,a=e.v,console.error("Create inheritance error:",a),this.showError("Failed to create inheritance: "+a.message),(o=document.getElementById("createInheritance")).querySelector(".btn-text").classList.remove("hidden"),o.querySelector(".btn-loader").classList.add("hidden"),o.disabled=!1;case 5:return e.p=5,this.hideLoading(),e.f(5);case 6:return e.a(2)}},e,this,[[0,4,5,6]])})),function(){return r.apply(this,arguments)})},{key:"showSuccess",value:function(e){var t=document.createElement("div");t.className="notification notification-success",t.innerHTML='\n            <div class="notification-content">\n                <span class="notification-icon">✅</span>\n                <span class="notification-message">'.concat(e,"</span>\n            </div>\n        "),document.body.appendChild(t),setTimeout(function(){return t.classList.add("show")},100),setTimeout(function(){t.classList.remove("show"),setTimeout(function(){return t.remove()},300)},3e3)}},{key:"updateSummary",value:function(){var e=document.getElementById("heirAddress").value.trim(),t=document.getElementById("solAmount").value,n=this.getInactivityDays("inactivityPeriod","customDays");document.getElementById("summaryAmount").textContent=t?"".concat(t," SOL"):"0 SOL",document.getElementById("summaryHeir").textContent=e?this.shortenAddress(e):"Not set",document.getElementById("summaryPeriod").textContent="".concat(n," days")}},{key:"updateTokenSummary",value:function(){var e=document.getElementById("tokenHeirAddress").value.trim(),t=document.getElementById("tokenAmount").value,n=document.getElementById("tokenMint").value.trim(),r=this.getInactivityDays("tokenInactivityPeriod","tokenCustomDays");document.getElementById("tokenSummaryAmount").textContent=t?"".concat(t," tokens"):"0 tokens",document.getElementById("tokenSummaryHeir").textContent=e?this.shortenAddress(e):"Not set",document.getElementById("tokenSummaryMint").textContent=n?this.shortenAddress(n):"Not set",document.getElementById("tokenSummaryPeriod").textContent="".concat(r," days")}},{key:"getInactivityDays",value:function(e,t){var n=document.getElementById(e),r=document.getElementById(t);return"custom"===n.value?parseInt(r.value)||30:parseInt(n.value)||30}},{key:"validateSolanaAddress",value:function(e){return!(!e||44!==e.length)&&/^[1-9A-HJ-NP-Za-km-z]+$/.test(e)}},{key:"shortenAddress",value:function(e){return e?"".concat(e.slice(0,4),"...").concat(e.slice(-4)):""}},{key:"viewOnExplorer",value:function(){if(this.successSignature){var e="mainnet-beta"===this.network?"https://solscan.io/tx/".concat(this.successSignature):"https://solscan.io/tx/".concat(this.successSignature,"?cluster=").concat(this.network);window.open(e,"_blank")}}},{key:"showLoading",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...",t=document.getElementById("loadingOverlay");t.querySelector(".loading-text").textContent=e,t.classList.remove("hidden")}},{key:"hideLoading",value:function(){document.getElementById("loadingOverlay").classList.add("hidden")}},{key:"showError",value:function(e){var t=document.createElement("div");t.className="notification notification-error",t.innerHTML='\n            <div class="notification-content">\n                <span class="notification-icon">❌</span>\n                <span class="notification-message">'.concat(e,"</span>\n            </div>\n        "),document.body.appendChild(t),setTimeout(function(){return t.classList.add("show")},100),setTimeout(function(){t.classList.remove("show"),setTimeout(function(){return t.remove()},300)},5e3)}}],t&&c(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,o,a,u}();document.addEventListener("DOMContentLoaded",function(){window.inheritanceSetup=new d})})();
//# sourceMappingURL=inheritance.js.map